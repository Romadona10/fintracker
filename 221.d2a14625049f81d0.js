"use strict";(self.webpackChunkFintracker=self.webpackChunkFintracker||[]).push([[221],{9221:(tt,E,s)=>{s.r(E),s.d(E,{AuthModule:()=>K});var h=s(177),p=s(8498),t=s(7705);let w=(()=>{class r{static{this.\u0275fac=function(o){return new(o||r)}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-auth"]],decls:2,vars:0,consts:[[1,"auth-container"]],template:function(o,e){1&o&&(t.j41(0,"div",0),t.nrm(1,"router-outlet"),t.k0s())},dependencies:[p.n3]})}}return r})();var n=s(9417),F=s(4796),k=s(5416),m=s(5596),g=s(8834),c=s(882),_=s(7575),b=s(9631),C=s(9213);function I(r,l){1&r&&t.nrm(0,"mat-progress-bar",16)}function R(r,l){1&r&&(t.j41(0,"mat-error"),t.EFF(1," Email is required "),t.k0s())}function y(r,l){1&r&&(t.j41(0,"mat-error"),t.EFF(1," Enter a valid email "),t.k0s())}function j(r,l){1&r&&(t.j41(0,"mat-error"),t.EFF(1," Password is required "),t.k0s())}function T(r,l){1&r&&(t.j41(0,"mat-error"),t.EFF(1," Email is required "),t.k0s())}function G(r,l){1&r&&(t.j41(0,"mat-error"),t.EFF(1," Enter a valid email "),t.k0s())}function x(r,l){if(1&r){const i=t.RV6();t.j41(0,"mat-card",0)(1,"mat-card-title"),t.EFF(2,"Forgot Password"),t.k0s(),t.j41(3,"mat-card-content")(4,"form",5),t.bIt("ngSubmit",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.onSubmitForgotPassword())}),t.j41(5,"mat-form-field",6)(6,"mat-label"),t.EFF(7,"Email"),t.k0s(),t.nrm(8,"input",7),t.DNE(9,T,2,0,"mat-error",8),t.DNE(10,G,2,0,"mat-error",8),t.k0s(),t.j41(11,"button",11),t.EFF(12,"Reset Password"),t.k0s()()()()}if(2&r){const i=t.XpG();let o,e;t.R7$(4),t.Y8G("formGroup",i.forgottenPasswordForm),t.R7$(5),t.Y8G("ngIf",null==(o=i.forgottenPasswordForm.get("email"))?null:o.hasError("required")),t.R7$(1),t.Y8G("ngIf",null==(e=i.forgottenPasswordForm.get("email"))?null:e.hasError("email")),t.R7$(1),t.Y8G("disabled",i.forgottenPasswordForm.invalid)}}let N=(()=>{class r{constructor(i,o,e,a){this.fb=i,this.router=o,this.authService=e,this.snackbar=a,this.hidePassword=!0,this.isforgetPasswordMode=!1,this.isLoading=!1,this.loginForm=this.fb.group({email:["",[n.k0.required,n.k0.email]],password:["",[n.k0.required,n.k0.minLength(6)]]}),this.forgottenPasswordForm=this.fb.group({email:["",[n.k0.required,n.k0.email]]})}togglePasswordVisibility(){this.hidePassword=!this.hidePassword}onSubmitLogin(){if(this.loginForm.valid){this.isLoading=!0;const{email:i,password:o}=this.loginForm.value;this.authService.login(i,o).subscribe(e=>{this.snackbar.open("Login successful","close",{duration:3e3}),this.router.navigateByUrl("/dashboard/dashboard-ui")},e=>{console.error("Login error:",e),this.snackbar.open("Login error, maybe due to invalid credentials or network issues","close",{duration:3e3})}).add(()=>{this.isLoading=!1})}}onSubmitForgotPassword(){if(this.forgottenPasswordForm.valid){const{email:i}=this.forgottenPasswordForm.value;console.log("Forgot password request",{email:i})}}switchToRegister(){this.router.navigateByUrl("/auth/register")}switchToForgotPassword(){this.isforgetPasswordMode=!0}static{this.\u0275fac=function(o){return new(o||r)(t.rXU(n.ok),t.rXU(p.Ix),t.rXU(F.u),t.rXU(k.UG))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-login"]],decls:31,vars:11,consts:[[1,"auth-card"],[1,"progress-bar"],["mode","indeterminate",4,"ngIf"],[1,"img-logo"],["src","/assets/romalogo.webp","alt","",1,"logo"],[3,"formGroup","ngSubmit"],["appearance","outline",1,"full-width"],["matInput","","formControlName","email","placeholder","Enter your email"],[4,"ngIf"],["matInput","","formControlName","password","placeholder","Enter your password",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["mat-raised-button","","color","primary",3,"disabled"],[1,"auth-actions"],["mat-button","","color","warn",3,"click"],["mat-button","","color","accent",3,"click"],["class","auth-card",4,"ngIf"],["mode","indeterminate"]],template:function(o,e){if(1&o&&(t.j41(0,"mat-card",0)(1,"div",1),t.DNE(2,I,1,0,"mat-progress-bar",2),t.k0s(),t.j41(3,"div",3),t.nrm(4,"img",4),t.k0s(),t.j41(5,"mat-card-title"),t.EFF(6,"Login"),t.k0s(),t.j41(7,"mat-card-content")(8,"form",5),t.bIt("ngSubmit",function(){return e.onSubmitLogin()}),t.j41(9,"mat-form-field",6)(10,"mat-label"),t.EFF(11,"Email"),t.k0s(),t.nrm(12,"input",7),t.DNE(13,R,2,0,"mat-error",8),t.DNE(14,y,2,0,"mat-error",8),t.k0s(),t.j41(15,"mat-form-field",6)(16,"mat-label"),t.EFF(17,"Password"),t.k0s(),t.nrm(18,"input",9),t.j41(19,"button",10),t.bIt("click",function(){return e.togglePasswordVisibility()}),t.j41(20,"mat-icon"),t.EFF(21),t.k0s()(),t.DNE(22,j,2,0,"mat-error",8),t.k0s(),t.j41(23,"button",11),t.EFF(24,"Login"),t.k0s()()(),t.j41(25,"mat-card-actions",12)(26,"button",13),t.bIt("click",function(){return e.switchToForgotPassword()}),t.EFF(27,"Forgot Password?"),t.k0s(),t.j41(28,"button",14),t.bIt("click",function(){return e.switchToRegister()}),t.EFF(29,"Create Account"),t.k0s()()(),t.DNE(30,x,13,4,"mat-card",15)),2&o){let a,u,f;t.R7$(2),t.Y8G("ngIf",e.isLoading),t.R7$(6),t.Y8G("formGroup",e.loginForm),t.R7$(5),t.Y8G("ngIf",null==(a=e.loginForm.get("email"))?null:a.hasError("required")),t.R7$(1),t.Y8G("ngIf",null==(u=e.loginForm.get("email"))?null:u.hasError("email")),t.R7$(4),t.Y8G("type",e.hidePassword?"password":"text"),t.R7$(1),t.BMQ("aria-label","Hide password")("aria-pressed",e.hidePassword),t.R7$(2),t.JRh(e.hidePassword?"visibility_off":"visibility"),t.R7$(1),t.Y8G("ngIf",null==(f=e.loginForm.get("password"))?null:f.hasError("required")),t.R7$(1),t.Y8G("disabled",e.loginForm.invalid),t.R7$(7),t.Y8G("ngIf",e.isforgetPasswordMode)}},dependencies:[h.bT,m.RN,m.YY,m.m2,m.dh,g.$z,g.iY,n.qT,n.me,n.BC,n.cb,n.j4,n.JD,c.rl,c.nJ,c.TL,c.yw,_.HM,b.fg,C.An],styles:[".auth-card[_ngcontent-%COMP%]{max-width:400px;margin:20px auto;padding:20px;box-shadow:0 2px 10px #0000001a}.img-logo[_ngcontent-%COMP%]{display:flex;justify-content:center}.img-logo[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{border-radius:50%;width:100px;height:100px;vertical-align:middle}.auth-title[_ngcontent-%COMP%]{text-align:center;font-size:24px;margin-bottom:10px}.full-width[_ngcontent-%COMP%]{width:100%}.auth-button-container[_ngcontent-%COMP%]{margin-top:20px}.auth-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.action-link[_ngcontent-%COMP%]{text-transform:none}"]})}}return r})();const M=["video"],$=["canvas"];function L(r,l){1&r&&t.nrm(0,"mat-progress-bar",21)}function Y(r,l){1&r&&t.nrm(0,"video",22,23)}function S(r,l){if(1&r){const i=t.RV6();t.j41(0,"button",24),t.bIt("click",function(){t.eBV(i);const e=t.XpG();return t.Njj(e.captureImage())}),t.EFF(1,"Capture Image"),t.k0s()}}function O(r,l){if(1&r&&t.nrm(0,"img",25),2&r){const i=t.XpG();t.Y8G("src",i.capturedImage,t.B4B)}}function U(r,l){1&r&&(t.j41(0,"mat-error"),t.EFF(1," Name is required "),t.k0s())}function D(r,l){1&r&&(t.j41(0,"mat-error"),t.EFF(1," Email is required "),t.k0s())}function B(r,l){1&r&&(t.j41(0,"mat-error"),t.EFF(1," Enter a valid email "),t.k0s())}function V(r,l){1&r&&(t.j41(0,"mat-error"),t.EFF(1," Password is required "),t.k0s())}function X(r,l){1&r&&(t.j41(0,"mat-error"),t.EFF(1," Password must be at least 6 characters "),t.k0s())}let A=(()=>{class r{constructor(i,o,e,a){this.fb=i,this.router=o,this.authService=e,this.snackbar=a,this.hidePassword=!0,this.capturedImage=null,this.isLoading=!1,this.isVideoVisible=!0,this.isImageCaptured=!0,this.registerForm=this.fb.group({fullName:["",n.k0.required],email:["",[n.k0.required,n.k0.email]],password:["",[n.k0.required,n.k0.minLength(6)]]})}ngOnInit(){this.startCamera()}startCamera(){navigator.mediaDevices.getUserMedia({video:!0}).then(i=>{this.videoStream=i,this.videoElement.nativeElement.srcObject=i}).catch(i=>{console.error("Error accessing camera: ",i)})}captureImage(){const i=this.videoElement.nativeElement,o=this.canvasElement.nativeElement;o.width=i.videoWidth,o.height=i.videoHeight;const e=o.getContext("2d");e&&(e.drawImage(i,0,0,o.width,o.height),this.capturedImage=o.toDataURL("image/png"),this.isVideoVisible=!1,this.isImageCaptured=!1),this.stopCamera()}stopCamera(){this.videoStream&&this.videoStream.getTracks().forEach(o=>o.stop())}onSubmitRegister(){if(this.registerForm.valid){this.isLoading=!0;const i={fullName:this.registerForm.get("fullName")?.value,email:this.registerForm.get("email")?.value,password:this.registerForm.get("password")?.value};let o;if(this.capturedImage){const e=this.base64ToBlob(this.capturedImage,"image/png");o=new File([e],"profile-pic.png",{type:"image/png"})}setTimeout(()=>{this.authService.register(i,o).subscribe(e=>{this.snackbar.open("Registration successful","close"),this.router.navigateByUrl("/auth/login")},e=>{console.error("Registration error:",e),this.snackbar.open("Registration error, this email already exists","close")}).add(()=>{this.isLoading=!1})},5e3)}}base64ToBlob(i,o){const e=atob(i.split(",")[1]),a=new Uint8Array(e.length);for(let u=0;u<e.length;u++)a[u]=e.charCodeAt(u);return new Blob([a],{type:o})}togglePasswordVisibility(){this.hidePassword=!this.hidePassword}switchToLogin(){this.router.navigateByUrl("/auth/login")}static{this.\u0275fac=function(o){return new(o||r)(t.rXU(n.ok),t.rXU(p.Ix),t.rXU(F.u),t.rXU(k.UG))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-register"]],viewQuery:function(o,e){if(1&o&&(t.GBs(M,5),t.GBs($,5)),2&o){let a;t.mGM(a=t.lsd())&&(e.videoElement=a.first),t.mGM(a=t.lsd())&&(e.canvasElement=a.first)}},decls:40,vars:15,consts:[[1,"auth-card"],[1,"progress-bar"],["mode","indeterminate",4,"ngIf"],[1,"img-logo"],["src","/assets/romalogo.webp","alt","",1,"logo"],[1,"camera-section"],["autoplay","",4,"ngIf"],["hidden",""],["canvas",""],["mat-raised-button","","color","primary",3,"click",4,"ngIf"],["alt","Captured Image","class","captured-image",3,"src",4,"ngIf"],[3,"formGroup","ngSubmit"],["appearance","outline",1,"full-width"],["matInput","","formControlName","fullName","placeholder","Enter your full name"],[4,"ngIf"],["matInput","","formControlName","email","placeholder","Enter your email"],["matInput","","formControlName","password","placeholder","Enter your password",3,"type"],["mat-icon-button","","matSuffix","","type","button",3,"click"],["mat-raised-button","","color","primary",3,"disabled"],[1,"auth-actions"],["mat-button","","color","accent",3,"click"],["mode","indeterminate"],["autoplay",""],["video",""],["mat-raised-button","","color","primary",3,"click"],["alt","Captured Image",1,"captured-image",3,"src"]],template:function(o,e){if(1&o&&(t.j41(0,"mat-card",0)(1,"div",1),t.DNE(2,L,1,0,"mat-progress-bar",2),t.k0s(),t.j41(3,"div",3),t.nrm(4,"img",4),t.k0s(),t.j41(5,"mat-card-title"),t.EFF(6,"Register"),t.k0s(),t.j41(7,"div",5),t.DNE(8,Y,2,0,"video",6),t.nrm(9,"canvas",7,8),t.DNE(11,S,2,0,"button",9),t.DNE(12,O,1,1,"img",10),t.k0s(),t.j41(13,"mat-card-content")(14,"form",11),t.bIt("ngSubmit",function(){return e.onSubmitRegister()}),t.j41(15,"mat-form-field",12)(16,"mat-label"),t.EFF(17,"Full Name"),t.k0s(),t.nrm(18,"input",13),t.DNE(19,U,2,0,"mat-error",14),t.k0s(),t.j41(20,"mat-form-field",12)(21,"mat-label"),t.EFF(22,"Email"),t.k0s(),t.nrm(23,"input",15),t.DNE(24,D,2,0,"mat-error",14),t.DNE(25,B,2,0,"mat-error",14),t.k0s(),t.j41(26,"mat-form-field",12)(27,"mat-label"),t.EFF(28,"Password"),t.k0s(),t.nrm(29,"input",16),t.j41(30,"button",17),t.bIt("click",function(){return e.togglePasswordVisibility()}),t.j41(31,"mat-icon"),t.EFF(32),t.k0s()(),t.DNE(33,V,2,0,"mat-error",14),t.DNE(34,X,2,0,"mat-error",14),t.k0s(),t.j41(35,"button",18),t.EFF(36,"Create Account"),t.k0s()()(),t.j41(37,"mat-card-actions",19)(38,"button",20),t.bIt("click",function(){return e.switchToLogin()}),t.EFF(39,"Already have an account? Login"),t.k0s()()()),2&o){let a,u,f,v,P;t.R7$(2),t.Y8G("ngIf",e.isLoading),t.R7$(6),t.Y8G("ngIf",e.isVideoVisible),t.R7$(3),t.Y8G("ngIf",e.isImageCaptured),t.R7$(1),t.Y8G("ngIf",e.capturedImage),t.R7$(2),t.Y8G("formGroup",e.registerForm),t.R7$(5),t.Y8G("ngIf",null==(a=e.registerForm.get("fullName"))?null:a.hasError("required")),t.R7$(5),t.Y8G("ngIf",null==(u=e.registerForm.get("email"))?null:u.hasError("required")),t.R7$(1),t.Y8G("ngIf",null==(f=e.registerForm.get("email"))?null:f.hasError("email")),t.R7$(4),t.Y8G("type",e.hidePassword?"password":"text"),t.R7$(1),t.BMQ("aria-label","Hide password")("aria-pressed",e.hidePassword),t.R7$(2),t.JRh(e.hidePassword?"visibility_off":"visibility"),t.R7$(1),t.Y8G("ngIf",null==(v=e.registerForm.get("password"))?null:v.hasError("required")),t.R7$(1),t.Y8G("ngIf",null==(P=e.registerForm.get("password"))?null:P.hasError("minlength")),t.R7$(1),t.Y8G("disabled",e.registerForm.invalid)}},dependencies:[h.bT,m.RN,m.YY,m.m2,m.dh,g.$z,g.iY,n.qT,n.me,n.BC,n.cb,n.j4,n.JD,c.rl,c.nJ,c.TL,c.yw,_.HM,b.fg,C.An],styles:[".auth-card[_ngcontent-%COMP%]{max-width:400px;margin:20px auto;padding:20px;box-shadow:0 2px 10px #0000001a}.auth-title[_ngcontent-%COMP%]{text-align:center;font-size:24px;margin-bottom:10px}.full-width[_ngcontent-%COMP%]{width:100%}.auth-button-container[_ngcontent-%COMP%]{margin-top:20px}.auth-actions[_ngcontent-%COMP%]{display:flex;justify-content:space-between}.action-link[_ngcontent-%COMP%]{text-transform:none}.camera-section[_ngcontent-%COMP%]{display:flex;flex-direction:column;border-radius:10%;margin-top:20px}.video-preview[_ngcontent-%COMP%], .captured-image[_ngcontent-%COMP%]{width:200px;height:250px;border-radius:50%;align-self:center;object-fit:cover;border:2px solid #3f51b5;margin-bottom:10px}.capture-button[_ngcontent-%COMP%]{margin-top:10px}.img-logo[_ngcontent-%COMP%]{display:flex;justify-content:center}.img-logo[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{border-radius:50%;width:100px;height:100px;vertical-align:middle}"]})}}return r})();var d=s(5351);let J=(()=>{class r{constructor(i,o,e){this.fb=i,this.dialogRef=o,this.data=e,this.editProfileForm=this.fb.group({fullName:[e.name,n.k0.required],email:[e.email,[n.k0.required,n.k0.email]]})}onSubmit(){this.editProfileForm.valid&&this.dialogRef.close(this.editProfileForm.value)}static{this.\u0275fac=function(o){return new(o||r)(t.rXU(n.ok),t.rXU(d.CP),t.rXU(d.Vh))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-edit-profile-dialog"]],decls:17,vars:2,consts:[["mat-dialog-title",""],[3,"formGroup","ngSubmit"],["appearance","outline",1,"full-width"],["matInput","","formControlName","fullName"],["matInput","","formControlName","email"],["mat-raised-button","","mat-dialog-close",""],["mat-raised-button","","color","primary",3,"disabled","click"]],template:function(o,e){1&o&&(t.j41(0,"h2",0),t.EFF(1,"Edit Profile"),t.k0s(),t.j41(2,"mat-dialog-content")(3,"form",1),t.bIt("ngSubmit",function(){return e.onSubmit()}),t.j41(4,"mat-form-field",2)(5,"mat-label"),t.EFF(6,"Full Name"),t.k0s(),t.nrm(7,"input",3),t.k0s(),t.j41(8,"mat-form-field",2)(9,"mat-label"),t.EFF(10,"Email"),t.k0s(),t.nrm(11,"input",4),t.k0s()()(),t.j41(12,"mat-dialog-actions")(13,"button",5),t.EFF(14,"Cancel"),t.k0s(),t.j41(15,"button",6),t.bIt("click",function(){return e.onSubmit()}),t.EFF(16,"Save Changes"),t.k0s()()),2&o&&(t.R7$(3),t.Y8G("formGroup",e.editProfileForm),t.R7$(12),t.Y8G("disabled",e.editProfileForm.invalid))},dependencies:[g.$z,n.qT,n.me,n.BC,n.cb,n.j4,n.JD,b.fg,c.rl,c.nJ,d.tx,d.BI,d.Yi,d.E7]})}}return r})();function q(r,l){if(1&r&&t.nrm(0,"img",4),2&r){const i=t.XpG();t.FS9("alt",i.user.name),t.Y8G("src",i.user.profileImage,t.B4B)}}const H=[{path:"",component:w,children:[{path:"",redirectTo:"login",pathMatch:"full"},{path:"login",component:N},{path:"register",component:A},{path:"profile",component:(()=>{class r{constructor(i,o,e){this.authService=i,this.dialog=o,this.router=e,this.user={name:"",email:"",profileImage:null}}ngOnInit(){this.fetchUserProfile()}fetchUserProfile(){this.authService.getProfile().subscribe(i=>{this.user.name=i.fullName,this.user.email=i.email,this.user.profileImage=`http://localhost:5000/uploads/${i.profileImage}`},i=>{console.error("Error fetching user profile:",i)})}editProfile(){this.dialog.open(J,{width:"400px",data:{name:this.user.name,email:this.user.email}}).afterClosed().subscribe(o=>{o&&(this.user.name=o.name,this.user.email=o.email)})}static{this.\u0275fac=function(o){return new(o||r)(t.rXU(F.u),t.rXU(d.bZ),t.rXU(p.Ix))}}static{this.\u0275cmp=t.VBU({type:r,selectors:[["app-profile"]],decls:16,vars:3,consts:[[1,"profile-card"],[1,"profile-info"],["class","profile-image",3,"src","alt",4,"ngIf"],["mat-raised-button","","color","accent",3,"click"],[1,"profile-image",3,"src","alt"]],template:function(o,e){1&o&&(t.j41(0,"mat-card",0)(1,"mat-card-title"),t.EFF(2,"Profile"),t.k0s(),t.j41(3,"mat-card-content")(4,"div",1),t.DNE(5,q,1,2,"img",2),t.j41(6,"p")(7,"strong"),t.EFF(8,"Name:"),t.k0s(),t.EFF(9),t.k0s(),t.j41(10,"p")(11,"strong"),t.EFF(12,"Email:"),t.k0s(),t.EFF(13),t.k0s()(),t.j41(14,"button",3),t.bIt("click",function(){return e.editProfile()}),t.EFF(15,"Edit Profile"),t.k0s()()()),2&o&&(t.R7$(5),t.Y8G("ngIf",e.user.profileImage),t.R7$(4),t.SpI(" ",e.user.name,""),t.R7$(4),t.SpI(" ",e.user.email,""))},dependencies:[h.bT,m.RN,m.m2,m.dh,g.$z],styles:[".profile-card[_ngcontent-%COMP%]{margin:auto}.profile-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;text-align:center}.profile-image[_ngcontent-%COMP%]{width:100px;height:100px;border-radius:50%;object-fit:cover;margin-bottom:10px}button[_ngcontent-%COMP%]{margin-top:10px}"]})}}return r})()}]}];let z=(()=>{class r{static{this.\u0275fac=function(o){return new(o||r)}}static{this.\u0275mod=t.$C({type:r})}static{this.\u0275inj=t.G2t({imports:[p.iI.forChild(H),p.iI]})}}return r})();var Q=s(9159),W=s(2798),Z=s(6600);let K=(()=>{class r{static{this.\u0275fac=function(o){return new(o||r)}}static{this.\u0275mod=t.$C({type:r})}static{this.\u0275inj=t.G2t({imports:[h.MD,z,m.Hu,g.Hl,n.X1,n.YN,W.Ve,d.hM,_.PO,Z.WX,b.fS,C.m_,c.RG,Q.tP]})}}return r})()}}]);